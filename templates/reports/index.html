{% extends "/common/layout.html" %}

{% block title %}
    <title>鑫方盛测试品台-测试报告</title>
{% endblock %}

{% block content %}

    <div class="row">

        <div class="col-md-12">
            <ul class="nav nav-pills nav-stacked">
                <li id="fis" class="active"><a href="javascript:void(0)">测试报告</a></li>
            </ul>
        </div>

    </div>

    <div class="row" style="margin-top: 10px">
        <div class="col-md-12">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <td>标题</td>
                        <td>执行状态</td>
                        <td>操作</td>
                    </tr>
                </thead>

                <tbody>
                {% for i in reports %}
                    <tr style="height: 25px">
                        <td><a target="_blank" href="/static/reports/{{ user_id }}_{{ i.backContent }}/report/index.html">{{ i.reportName }}</a></td>
                        {% if i.exeState == 0 %}
                            <td>执行中</td>
                        {% else %}
                            <td>完成</td>
                        {% endif %}
                        <td><a href="#" repid={{ i.id }} onclick=deleteReport(this)>删除</a><a href="#" style="margin-left: 50px;" repid={{ i.id }} onclick=deleteReportReal(this)>彻底删除</a></td>
            {#            <div style="margin-top: 10px;"></div>#}
                    </tr>
                {% endfor %}

                </tbody>

            </table>
        </div>
    </div>



    <script>
        function deleteReport(obj) {
            repid = $(obj).attr('repid');
            $.ajax({
                url: '/case/deleteReport',
                contentType: 'application/json',
                type: 'POST',
                dataType: 'json',
                data: JSON.stringify({'repid': repid}),
                success: function (resp) {
                    alert(resp.msg)
                    // 删除成功后，清除当前页面信息
                    var td = $(obj).parent().parent()
                    td.remove()
                }
            });


        }

        function deleteReportReal(obj) {
            repid = $(obj).attr('repid');
            $.ajax({
                url: '/case/deleteReportReal',
                contentType: 'application/json',
                type: 'POST',
                dataType: 'json',
                data: JSON.stringify({'repid': repid}),
                success: function (resp) {
                    alert(resp.msg)
                }
            });


        }

    </script>

{% endblock %}