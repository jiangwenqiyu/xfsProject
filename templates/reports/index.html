{% extends "/common/layout.html" %}

{% block content %}

    <table>
    <thead>
    <tr>
        <td style="padding-right: 450px;text-align: center;vertical-align: middle">标题</td>
        <td style="padding-right: 100px;text-align: center;vertical-align: middle">执行状态</td>
        <td style="padding-right: 0px;text-align: center;vertical-align: middle">操作</td></tr>
    </thead>

    <tbody>
    {% for i in reports %}
        <tr style="height: 25px">
            <td><a target="_blank" href="/static/reports/{{ user_id }}_{{ i.backContent }}/report/index.html">{{ i.reportName }}</a></td>
            {% if i.exeState == 0 %}
                <td style="color: orangered">执行中</td>
            {% else %}
                <td style="color: lightseagreen">完成</td>
            {% endif %}
            <td><a href="#" style="margin-left: 50px;" repid={{ i.id }} onclick=deleteReport(this)>删除</a><a href="#" style="margin-left: 50px;" repid={{ i.id }} onclick=deleteReportReal(this)>彻底删除</a></td>
{#            <div style="margin-top: 10px;"></div>#}
        </tr>
    {% endfor %}

    </tbody>
    </table>



    <script>
        function deleteReport(obj) {
            repid = $(obj).attr('repid');
            $.ajax({
                url: '/case/deleteReport',
                contentType: 'application/json',
                type: 'POST',
                dataType: 'json',
                data: JSON.stringify({'repid': repid}),
                success: function (resp) {
                    alert(resp.msg)
                    // 删除成功后，清除当前页面信息
                    var td = $(obj).parent().parent()
                    td.remove()
                }
            });


        }

        function deleteReportReal(obj) {
            repid = $(obj).attr('repid');
            $.ajax({
                url: '/case/deleteReportReal',
                contentType: 'application/json',
                type: 'POST',
                dataType: 'json',
                data: JSON.stringify({'repid': repid}),
                success: function (resp) {
                    alert(resp.msg)
                }
            });


        }

    </script>

{% endblock %}